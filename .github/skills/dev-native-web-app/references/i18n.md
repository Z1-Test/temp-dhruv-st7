# Internationalization (i18n) Best Practices

## What is it?

Internationalization (i18n) is designing your application to support multiple languages and regions without code changes. Localization (l10n) is the actual translation and adaptation for specific locales.

## Why prioritize i18n?

- **Global Reach**: Access users in 195+ countries
- **User Experience**: Users prefer content in their language
- **Market Expansion**: New revenue opportunities
- **SEO Benefits**: Localized content ranks in local searches
- **Accessibility**: Language support aids comprehension

---

## HTML Language Attributes

### Document Language

```html
<!-- Set primary language on <html> -->
<html lang="en">

<!-- For Arabic, Hebrew, etc. - add direction -->
<html lang="ar" dir="rtl">

<html lang="he" dir="rtl">
```

### Language Changes

```html
<!-- Mark language changes within content -->
<p>
  The French phrase 
  <span lang="fr">"c'est la vie"</span> 
  means "that's life."
</p>

<!-- Block-level language change -->
<blockquote lang="de" dir="ltr">
  Die Grenzen meiner Sprache bedeuten die Grenzen meiner Welt.
</blockquote>
```

### Content That Shouldn't Be Translated

```html
<!-- Prevent translation of code, brand names, etc. -->
<code translate="no">npm install</code>
<span translate="no">iPhone</span>
<pre translate="no">function example() {}</pre>
```

---

## hreflang for Multi-Language SEO

### Basic Implementation

```html
<head>
  <!-- Language alternatives -->
  <link rel="alternate" hreflang="en" href="https://example.com/en/">
  <link rel="alternate" hreflang="en-US" href="https://example.com/en-us/">
  <link rel="alternate" hreflang="en-GB" href="https://example.com/en-gb/">
  <link rel="alternate" hreflang="es" href="https://example.com/es/">
  <link rel="alternate" hreflang="de" href="https://example.com/de/">
  <link rel="alternate" hreflang="ja" href="https://example.com/ja/">
  
  <!-- Default for unmatched languages -->
  <link rel="alternate" hreflang="x-default" href="https://example.com/">
</head>
```

### URL Structures

| Pattern | Example | Pros | Cons |
|---------|---------|------|------|
| Subdirectory | `example.com/de/` | Easy setup, shared domain authority | Less country targeting |
| Subdomain | `de.example.com` | Geographic hosting possible | More setup, split authority |
| ccTLD | `example.de` | Strong country signal | Most expensive, separate sites |

### hreflang Rules

- Every page must reference ALL language versions (including itself)
- Use consistent URL patterns across all versions
- Include `x-default` for fallback
- Ensure return links (A references B, B references A)

---

## Right-to-Left (RTL) Support

### CSS Logical Properties

Replace physical properties with logical equivalents that automatically flip for RTL:

| Physical (Don't Use) | Logical (Use This) |
|---------------------|-------------------|
| `margin-left` | `margin-inline-start` |
| `margin-right` | `margin-inline-end` |
| `padding-left` | `padding-inline-start` |
| `padding-right` | `padding-inline-end` |
| `left` | `inset-inline-start` |
| `right` | `inset-inline-end` |
| `text-align: left` | `text-align: start` |
| `text-align: right` | `text-align: end` |
| `border-left` | `border-inline-start` |
| `border-right` | `border-inline-end` |
| `float: left` | `float: inline-start` |
| `width` | `inline-size` |
| `height` | `block-size` |

### Practical Examples

```css
/* BEFORE: Physical properties (won't flip for RTL) */
.card {
  margin-left: 1rem;
  padding-right: 2rem;
  border-left: 3px solid blue;
  text-align: left;
}

/* AFTER: Logical properties (auto-flip for RTL) */
.card {
  margin-inline-start: 1rem;
  padding-inline-end: 2rem;
  border-inline-start: 3px solid blue;
  text-align: start;
}
```

### RTL-Aware Icons

```css
/* Flip directional icons for RTL */
[dir="rtl"] .icon-arrow-right {
  transform: scaleX(-1);
}

/* Or use logical property */
.icon-arrow-forward {
  /* Points in reading direction */
}
```

### RTL-Safe Shorthand

```css
/* Shorthand with logical values */
.element {
  /* Works in both LTR and RTL */
  margin-block: 1rem;      /* top/bottom */
  margin-inline: 2rem;     /* start/end */
  padding-block: 0.5rem;
  padding-inline: 1rem;
  
  /* Inset (positioning) */
  inset-block: 0;          /* top/bottom: 0 */
  inset-inline: auto 0;    /* start: auto, end: 0 */
}

---

## Text Expansion & Layout

- Reserve space for up to 40% text expansion in UI layouts.
- Prefer flexible containers (`minmax`, `auto`, `clamp`) over fixed widths.
- Avoid truncation for essential UI labels; use wrapping and adaptive spacing.

---

## Multi-Script Font Stack

```css
:root {
  --font-family-sans:
    "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI",
    /* Japanese */ "Hiragino Kaku Gothic ProN", "Yu Gothic", "Meiryo",
    /* Chinese */ "PingFang SC", "Microsoft YaHei",
    /* Korean */ "Malgun Gothic", /* Arabic */ "Geeza Pro", "Simplified Arabic",
    sans-serif;
}

/* Script-specific adjustments */
:lang(ja),
:lang(zh),
:lang(ko) {
  line-height: 1.7;
  font-size: 1.05em;
}

:lang(ar),
:lang(he) {
  line-height: 1.8;
}
```
```

---

## Intl API for Formatting

### Date Formatting

```javascript
const date = new Date('2025-01-15T10:30:00Z');

// Different locales
new Intl.DateTimeFormat('en-US').format(date);    // "1/15/2025"
new Intl.DateTimeFormat('en-GB').format(date);    // "15/01/2025"
new Intl.DateTimeFormat('de-DE').format(date);    // "15.1.2025"
new Intl.DateTimeFormat('ja-JP').format(date);    // "2025/1/15"

// With options
new Intl.DateTimeFormat('en-US', {
  dateStyle: 'full',
  timeStyle: 'short'
}).format(date);
// "Wednesday, January 15, 2025 at 10:30 AM"
```

### Number Formatting

```javascript
const number = 1234567.89;

// Locale formatting
new Intl.NumberFormat('en-US').format(number);    // "1,234,567.89"
new Intl.NumberFormat('de-DE').format(number);    // "1.234.567,89"
new Intl.NumberFormat('fr-FR').format(number);    // "1 234 567,89"

// Percentages
new Intl.NumberFormat('en-US', {
  style: 'percent',
  maximumFractionDigits: 1
}).format(0.875);
// "87.5%"

// Compact notation
new Intl.NumberFormat('en-US', {
  notation: 'compact'
}).format(1500000);
// "1.5M"
```

### Currency Formatting

```javascript
const amount = 1234.56;

new Intl.NumberFormat('en-US', {
  style: 'currency',
  currency: 'USD'
}).format(amount);
// "$1,234.56"

new Intl.NumberFormat('de-DE', {
  style: 'currency',
  currency: 'EUR'
}).format(amount);
// "1.234,56 €"

new Intl.NumberFormat('ja-JP', {
  style: 'currency',
  currency: 'JPY'
}).format(amount);
// "￥1,235" (JPY has no decimals)
```

### Relative Time

```javascript
const rtf = new Intl.RelativeTimeFormat('en', { numeric: 'auto' });

rtf.format(-1, 'day');     // "yesterday"
rtf.format(2, 'hour');     // "in 2 hours"
rtf.format(-3, 'week');    // "3 weeks ago"

// Different locales
new Intl.RelativeTimeFormat('de').format(-1, 'day');  // "vor 1 Tag"
new Intl.RelativeTimeFormat('ja').format(2, 'hour');  // "2 時間後"
```

### Pluralization

```javascript
const pr = new Intl.PluralRules('en-US');

pr.select(0);   // "other"
pr.select(1);   // "one"
pr.select(2);   // "other"

// Use for pluralized strings
function pluralize(count, singular, plural) {
  return new Intl.PluralRules('en').select(count) === 'one' 
    ? singular 
    : plural;
}

pluralize(1, 'item', 'items');  // "item"
pluralize(5, 'item', 'items');  // "items"
```

### List Formatting

```javascript
const fruits = ['apple', 'banana', 'orange'];

new Intl.ListFormat('en', { type: 'conjunction' }).format(fruits);
// "apple, banana, and orange"

new Intl.ListFormat('en', { type: 'disjunction' }).format(fruits);
// "apple, banana, or orange"

new Intl.ListFormat('de', { type: 'conjunction' }).format(fruits);
// "apple, banana und orange"
```

---

## Content Localization

### Message Externalization

```javascript
// DON'T: Hardcoded strings
const greeting = 'Hello, ' + userName + '!';
const itemCount = count + ' items in cart';

// DO: Externalized messages
const messages = {
  en: {
    greeting: (name) => `Hello, ${name}!`,
    cartItems: (count) => `${count} item${count === 1 ? '' : 's'} in cart`
  },
  de: {
    greeting: (name) => `Hallo, ${name}!`,
    cartItems: (count) => `${count} Artikel im Warenkorb`
  }
};

const t = messages[currentLocale];
const greeting = t.greeting(userName);
```

### Common i18n Libraries

| Library | Framework | Notes |
|---------|-----------|-------|
| react-i18next | React | Most popular for React |
| vue-i18n | Vue | Official Vue solution |
| @angular/localize | Angular | Built-in Angular |
| next-intl | Next.js | Next.js optimized |
| Format.js | Any | ICU message format |

### ICU Message Format

```javascript
// Complex messages with pluralization and gender
const message = `{count, plural,
  =0 {No items}
  one {# item}
  other {# items}
} in {gender, select,
  male {his}
  female {her}
  other {their}
} cart`;
```

---

## Unicode and Encoding

### Always Use UTF-8

```html
<!-- Must be in first 1024 bytes -->
<meta charset="UTF-8">
```

### Handling Special Characters

```javascript
// String normalization
const str1 = 'café';     // é as single character
const str2 = 'café';     // e + combining acute accent

str1 === str2;           // false
str1.normalize('NFC') === str2.normalize('NFC');  // true

// Safe string comparison
str1.localeCompare(str2, 'en', { sensitivity: 'accent' });
```

### Text Directionality in Mixed Content

```html
<!-- Isolate bidirectional text -->
<p>
  The title is 
  <bdi>مرحبا بالعالم</bdi> 
  which means "Hello World".
</p>

<!-- Or use CSS -->
<span style="unicode-bidi: isolate;">مرحبا</span>
```

---

## Language Selector Best Practices

### Implementation

```html
<div class="language-switcher">
  <label for="language-select" class="visually-hidden">
    Choose language
  </label>
  <select id="language-select" onchange="switchLanguage(this.value)">
    <option value="en" selected>English</option>
    <option value="de">Deutsch</option>
    <option value="ja">日本語</option>
    <option value="ar">العربية</option>
  </select>
</div>
```

### Best Practices

| Do | Don't |
|----|-------|
| Display language in its native script | Use flags for languages |
| Place in consistent location (header/footer) | Hide language switcher |
| Remember user preference | Force redirect by IP |
| Allow override of auto-detection | Assume language from location |

### Why Not Flags?

- Language ≠ country (Spanish in 20+ countries)
- Some languages span many countries
- Some countries have multiple languages
- Flags can be politically sensitive

---

## i18n Checklist

### HTML

- [ ] `lang` attribute on `<html>`
- [ ] `dir="rtl"` for RTL languages
- [ ] `hreflang` links for all language versions
- [ ] `x-default` fallback
- [ ] UTF-8 charset declared
- [ ] `translate="no"` on code/brand names

### CSS

- [ ] CSS logical properties throughout
- [ ] No hardcoded LTR assumptions
- [ ] RTL-aware icons
- [ ] Font stacks include international fonts

### JavaScript

- [ ] Use Intl API for formatting
- [ ] No hardcoded strings
- [ ] Messages externalized
- [ ] Proper pluralization
- [ ] Locale-aware sorting/comparison

### Content

- [ ] No text in images (or provide alternatives)
- [ ] Date/time/number formats localized
- [ ] Currency properly formatted
- [ ] Expand room for longer translations

---

## Common Issues

| Issue | Solution |
|-------|----------|
| Layout breaks with RTL | Use CSS logical properties |
| Text truncation | Allow ~30% expansion for translations |
| Date format wrong | Use `Intl.DateTimeFormat` |
| Numbers formatted wrong | Use `Intl.NumberFormat` |
| Pluralization incorrect | Use `Intl.PluralRules` |
| Mixed directional text | Use `<bdi>` or `unicode-bidi` |
| Fonts missing glyphs | Include fonts for target scripts |
